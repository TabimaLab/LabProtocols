"0","primerHits <- function(primer, fn) {"
"0","    # Counts number of reads in which the primer is found"
"0","    nhits <- vcountPattern(primer, sread(readFastq(fn)), fixed = FALSE)"
"0","    return(sum(nhits > 0))"
"0","}"
"0","rbind(FWD.ForwardReads = sapply(FWD.orients, primerHits, fn = fnFs.filtN[[1]]),"
"0","    FWD.ReverseReads = sapply(FWD.orients, primerHits, fn = fnRs.filtN[[1]]),"
"0","    REV.ForwardReads = sapply(REV.orients, primerHits, fn = fnFs.filtN[[1]]),"
"0","    REV.ReverseReads = sapply(REV.orients, primerHits, fn = fnRs.filtN[[1]]))"
"1","                "
"1"," Forward"
"1"," Complement"
"1"," Reverse"
"1"," RevComp"
"1","
FWD.ForwardReads"
"1","   79343"
"1","          0"
"1","       0"
"1","       0"
"1","
FWD.ReverseReads"
"1","       0"
"1","          0"
"1","       0"
"1","    9408"
"1","
REV.ForwardReads"
"1","       0"
"1","          0"
"1","       0"
"1","   10625"
"1","
REV.ReverseReads"
"1","   78858"
"1","          0"
"1","       0"
"1","       0"
"1","
"
"0","cutadapt <- ""/usr/bin/cutadapt"" # CHANGE ME to the cutadapt path on your machine"
"0",""
"0","path.cut <- file.path(""~/filtN/"", ""cutadapt"")"
"0","if(!dir.exists(path.cut)) dir.create(path.cut)"
"0","fnFs.cut <- file.path(path.cut, basename(fnFs))"
"0","fnRs.cut <- file.path(path.cut, basename(fnRs))"
"0","FWD.RC <- dada2:::rc(FWD)"
"0","REV.RC <- dada2:::rc(REV)"
"0","# Trim FWD and the reverse-complement of REV off of R1 (forward reads)"
"0","R1.flags <- paste(""-g"", FWD, ""-a"", REV.RC)"
"0","# Trim REV and the reverse-complement of FWD off of R2 (reverse reads)"
"0","R2.flags <- paste(""-G"", REV, ""-A"", FWD.RC)"
