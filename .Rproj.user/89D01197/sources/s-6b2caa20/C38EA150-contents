---
title: "Lab_4"
author: "Manning DelCogliano"
date: '2023-02-15'
output: html_document
---

## How to Improve Read Quality

1. To remove the adapters on the R2 sequences, we can use the ```ILLUMINACLIP``` function of Trimmomatic to cut the known adapters off of the end of the desired sequence. 

2. Because the last few base pairs in the files seem to have a lower quality than the rest, we should try removing them. This can be done by using the ```CROP``` command and setting it to remove 7 bp from the end of each of the sequence reads.

3. For those files that have reads that are shorter than expected, we can use the ```MINLEN``` funtion to drop reads below a specific length, which I would chose to be 145bp, as we were expecting 150bp.

4. For overall low quality reads, we can use a number of funtions, but I would chose the ```SLIDINGWINDOW``` command to remove regions of base pairs that are below the set quality threshold. This does not just measure a set of reads, but measures via a sliding window to garner a more apt mean quality of reads.


### To trim the FASTQC files of R1 

#### First try ILLUMINACLIP to cut off adaptor

```
java -jar /Smaug_SSD/bin/Trimmomatic-0.39/trimmomatic-0.39.jar PE -threads 1 NB0621_05_S166_R1_001.fastq.gz NB0621_05_S166_R2_001.fastq.gz IlluminaTrim_R1.fastq.gz IlluminaTrim_R1.Unpaired.fastq.gz lluminaTrim_R2.fastq.gz lluminaTrim_R2.Unpaired.fastq.gz ILLUMINACLIP:/Smaug_SSD/bin/Trimmomatic-0.39/adapters/TruSeq3-PE.fa:2:30:10:2:True

/Smaug_SSD/bin/fastqc -o ~/Genome/Genome_backup/S166/QC_trim IlluminaTrim_R1.fastq.gz 
/Smaug_SSD/bin/fastqc -o ~/Genome/Genome_backup/S166/QC_trim/ lluminaTrim_R2.fastq.gz 
```

#### Testing SLIDINGWINDOW to measure quality within a sliding window frame *and* to remove adapters

```
java -jar /Smaug_SSD/bin/Trimmomatic-0.39/trimmomatic-0.39.jar PE -threads 1 NB0621_05_S166_R1_001.fastq.gz NB0621_05_S166_R1_001.fastq.gz Clean_S166_R1.fastq.gz Clean_S166_R1.Unpaired.fastq.gz Clean_S166_R2.fastq.gz Clean_S166_R2.Unpaired.fastq.gz ILLUMINACLIP:/Smaug_SSD/bin/Trimmomatic-0.39/adapters/TruSeq3-PE.fa:2:30:10:2:True MINLEN:145

/Smaug_SSD/bin/fastqc -o ~/Genome/Genome_backup/S166/QC_trim Clean_S166_R1.fastq.gz
/Smaug_SSD/bin/fastqc -o ~/Genome/Genome_backup/S166/QC_trim Clean_S166_R2.fastq.gz
```

##### These two trials are located in /Tabima_lab/homes/mdelcogliano/Genome/Genome_backup/S166/QC_trim

### Was this trimming worth it?

##### Forward

For the forward read, the trimming that was run does not appear to have significantly cleaned up the read quality. The per base sequence quality and the GC sequence content still fail their thresholds, as we can see complete divergences between A=T and C=G, as well as double peaks in the experimental GC content instead of it overlapping with the theoretical line. The cleanup for the forward reads did not seem to help.

##### Reverse

Trimming the reverse reads were more successful. While ILLUMINACLIP does not appear to have been useful, SLIDINGWINDOW appears to have increased the quality of the reads. Initially, there were adapters, overrepresented sequences, as well as the host of problems surrounding individual per base sequence quality issues. After trimming using the SLIDINGWINDOW of Trimmomatic, the overrepresented sequences and adapter content have been eliminated and now pass the threshold for qualtiy. For example:

![adapter content before trimming](/Tabima_lab/homes/mdelcogliano/Genome/Genome_backup/S166/QC_trim/before.png)

![adapter content after trimming](/Tabima_lab/homes/mdelcogliano/Genome/Genome_backup/S166/QC_trim/after.png)

It also appears as if the per tile sequence quality and the per base sequence quality have improved. This makes sense that if only one of the trimming attempts were to have significantly improved the read quality that it would have been SLIDINGWINDOW because of its ability to trim based upon small areas of sequence quality as well as trimming the adapters, unlike ILLUMINACLIP.

Overall, it was worth it to trim the reverse read using SLIDINGWINDOW because it improved the read quality of our sequences.